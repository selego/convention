# Security check

## Injection defence

- [ ] Sanitize app data against schema [Joi](https://github.com/sideway/joi), [yup](https://github.com/jquense/yup). Explanation [stackoverflow](https://stackoverflow.com/questions/56187802/preventing-nosql-injection-isnt-mongoose-supposed-to-convert-inputs-based-on-g)
- [ ] Add [SAST](https://owasp.org/www-community/Source_Code_Analysis_Tools) and [DAST](https://owasp.org/www-project-zap/) tools to CI/CD process

[Github action](https://github.com/zaproxy/action-baseline) for OWASP ZAP
[Github action](https://github.com/AppThreat/sast-scan) for SAST scanning

## Broken authentication

- [ ] Brute force defense. [Express-brute](https://github.com/AdamPflug/express-brute) middleware
- [ ] No default credentials for production anywhere
- [ ] Weak password check for [top 10000](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/10-million-password-list-top-10000.txt) worst passwords, when user registers or changes password
- [ ] Password length should be at least 8 characters if chosen by the user and 6 if generated automatically
- [ ] Limit or delay failed login attempts
- [ ] No "knoledge-based" password recovery
- [ ] Password stored as hashes
- [ ] Access tokens are invalidated during logout
- [ ] Access tokens are invalidated during period of inactivity ([refresh_tokens](https://auth0.com/blog/refresh-tokens-what-are-they-and-when-to-use-them/))
- [ ] Two factor auth where possible

## Sensitive Data Exposure

- [ ] No env files or inlined keys/passwords are in appliction repository
- [ ] Check if any old crypto algorithms are used in the app
- [ ] Check if only secure protocols are used. HTTPs only

## XML External Entities (XXE)
If dealing with soap or other XML services

## Broken access control

- [ ] Check if all private routes are auth-controlled
- [ ] Not pass sensitive data in the URL query
- [ ] Minimize CORS usage
- [ ] Log access control failures, report admin, when failures are repeated
- [ ] Integrational tests

## Security Misconfiguration

- [ ] Development / testing / production environments should be identical, but with different credentials. Containerzisation. Docker?
- [ ] Automated deployment
- [ ] Make sure, that dependencies are up-to-date and have no vulrenabilities
- [ ] Use [security headers](https://wiki.owasp.org/index.php/OWASP_Secure_Headers_Project#tab=Headers)
- [ ] Automated process of checking the configuration of the environment
- [ ] No stack traces as error messages

## Cross-Site Scripting (XSS)

Actually not that important in React applications, as react sanitizes input

## Insecure Deserialization
Not much applicable to what's currently done

## Using components with known vulnerabilities

- [ ] Remove all unused libraries/modules/frameworks/files/documentation
- [ ] Continuously inventory the versions of both client-side and server-side components (e.g. frameworks, libraries) and their dependencies using tools like versions, DependencyCheck, retire.js, etc. Continuously monitor sources like CVE and NVD for vulnerabilities in the components. Use software composition analysis tools to automate the process.
- [ ] Subscribe to email alerts for security vulnerabilities related to components you use.
- [ ] Monitor for libraries and components that are unmaintained or do not create security patches for older versions.

## Insufficient Logging & Monitoring

- [ ] Ensure that logs are generated in a format that can be easily consumed by a centralized log management solutions.
- [ ] Read-only db for high value transactions to prevent deletion of sensitive data
- [ ] Establish effective monitoring and alerting such that suspicious activities are detected and responded to in a timely fashion.
- [ ] Read-only db for high value transactions to prevent deletion of sensitive data
- [ ] Establish or adopt an incident response and recovery plan, such as [NIST 800-61 rev 2](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf) or later
